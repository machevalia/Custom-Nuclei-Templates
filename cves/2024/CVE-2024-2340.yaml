id: CVE-2024-2340

info:
  name: WordPress Avada Theme Version Enumeration and Directory Index Check
  author: machevalia
  severity: medium
  tags: wordpress, avada, enumeration

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/themes/Avada/style.css"

    extractors:
      - type: regex
        part: body
        regex:
          - 'Version:\s*(7\.([0-9]{1,2})\.([0-9]{1,2}))'
        group: 1
    
    matchers:
      - type: word
        words:
          - "Version: 7"
        part: body
        condition: and

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/uploads/fusion-forms/"

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Index of"
        part: body

    extractors:
     - type: regex
       part: body
       regex:
         - '<a href="[^"]*">([^<]+)</a>'
       group: 1
